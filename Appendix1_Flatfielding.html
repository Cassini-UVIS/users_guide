
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5. Flatfielding &#8212; Cassini UVIS User Guide</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6. Definitions and technical terms" href="Appendix2.html" />
    <link rel="prev" title="4. Bibliography" href="bibliography.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Cassini UVIS User Guide</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Cassini UVIS User Guide
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01_uvis_on_pds.html">
   1. Cassini UVIS data on the PDS system
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="02_pds_data_structure.html">
   2. PDS Data Structure
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="03_calibration.html">
   3. UVIS Calibration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   4. Bibliography
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   5. Flatfielding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Appendix2.html">
   6. Definitions and technical terms
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Appendix1_Flatfielding.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/cassini-uvis/users_guide"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/cassini-uvis/users_guide/issues/new?title=Issue%20on%20page%20%2FAppendix1_Flatfielding.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definitions-and-instrumental-details">
   5.1. Definitions and Instrumental Details
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#methods-for-obtaining-flatfield-corrections">
   5.2. Methods for Obtaining Flatfield Corrections
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spica-flatfields">
   5.3. Spica Flatfields
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#row-to-row-variations-in-detector-sensitivity">
     5.3.1. Row-to-Row Variations in Detector Sensitivity
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#column-to-column-varations-in-detector-sensitivity">
     5.3.2. Column-to-Column Varations in Detector Sensitivity
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Flatfielding</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#definitions-and-instrumental-details">
   5.1. Definitions and Instrumental Details
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#methods-for-obtaining-flatfield-corrections">
   5.2. Methods for Obtaining Flatfield Corrections
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#spica-flatfields">
   5.3. Spica Flatfields
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#row-to-row-variations-in-detector-sensitivity">
     5.3.1. Row-to-Row Variations in Detector Sensitivity
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#column-to-column-varations-in-detector-sensitivity">
     5.3.2. Column-to-Column Varations in Detector Sensitivity
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="flatfielding">
<h1><span class="section-number">5. </span>Flatfielding<a class="headerlink" href="#flatfielding" title="Permalink to this headline">¶</a></h1>
<blockquote>
<div><p>Andrew Steffl <span id="id1">[<a class="reference internal" href="bibliography.html#id6">Steffl, 2005</a>]</span>, Appendix A</p>
</div></blockquote>
<p>All instruments have their own imperfections and idiosyncracies that need to be dealt with properly in order for data to be successfully interpreted.
The Cassini UVIS is no exception; for any rigorous analysis of the UVIS data, careful attention must be paid to the detector flatfield correction.
The following is a somewhat technical description of the techniques used to derive the flatfield corrections for the UVIS EUV and FUV detectors.
These flatfields are ultimately derived from observations of the star Spica and were used in the analysis of all data in this thesis.
Reflecting their origin, these flatfields will be referred to as the Spica flatfields.
An independent flatfield correction for the FUV channel has been derived from observations of the local interstellar medium/interplanetary medium (Don Shemansky, private communication).
This second flatfield correction will be referred to as the LISM flatfield.</p>
<div class="section" id="definitions-and-instrumental-details">
<h2><span class="section-number">5.1. </span>Definitions and Instrumental Details<a class="headerlink" href="#definitions-and-instrumental-details" title="Permalink to this headline">¶</a></h2>
<p>The UVIS CODACON (Lawrence and McClintock, 1996) detectors are subdivided into 2<span class="math notranslate nohighlight">\(^16\)</span> pixels (1024 columns in the spectral dimension by 64 rows in the spatial dimension).
Individual UVIS pixels are not square.
Rather, they are 100 x 25 <span class="math notranslate nohighlight">\(\mu\)</span>m (spatial by spectral) in physical size and subtend a field of view of 1 x 0.25 mrad (1 mrad = 0.001 radians).</p>
<p>Both the EUV and FUV channels of UVIS are equipped with a 3-position slit changer mechanism.
The three positions are referred to as the</p>
<ul class="simple">
<li><p>occultation slit (8 mrad wide),</p></li>
<li><p>lo-resolution slit</p>
<ul>
<li><p>2.0 mrad wide for the EUV channel and 1.5 mrad wide for the FUV channel, and</p></li>
</ul>
</li>
<li><p>the hi-resolution slit</p>
<ul>
<li><p>1.0 mrad wide for the EUV channel and 0.75 mrad wide for the FUV channel.</p></li>
</ul>
</li>
</ul>
<p>The FUV occultation slit is equipped with a cylindrical MgF<span class="math notranslate nohighlight">\(_2\)</span> lens designed to spread light from a point source perpendicular to the dispersion direction, thereby preventing the FUV detector from saturating during observations of particularly bright stars.
The presence of this lens and its support structure reduce the effective field of view to an 8x8 mrad area in the center of the slit (where the lens is transmitting) and two 11x8 mrad windows at the ends of the slit.
As such, the FUV occultation slit is poorly suited for observations designed to determine the detector flatfield correction, and therefore, the FUV lo-resolution slit was used.</p>
<p>A Cartesian coordinate system has been defined for the Cassini spacecraft.
The boresights of the UVIS EUV and FUV channels are defined as the geometric center of the CODACON detectors (spectral pixel 511.5, spatial pixel 31.5).
The UVIS boresight (and the boresights of the other remote sensing instruments) is nominally aligned to the spacecraft -Y axis, while the UVIS entrance slits are approximately parallel with the spacecraft Z axis.
The instrument azimuth angle (<span class="math notranslate nohighlight">\(\phi\)</span>) is defined as the angle a vector makes with respect to the spacecraft Y-Z axis, measured from the Z axis.
The spacecraft coordinate system is shown relative to the orientation of UVIS in <a class="reference internal" href="#fig-uvis-coordinates"><span class="std std-numref">Fig. 5.1</span></a>.</p>
<div class="figure align-default" id="fig-uvis-coordinates">
<img alt="UVIS Coordinates relative to Spacecraft cartesian system." src="_images/fig_A1_steffl.png" />
<p class="caption"><span class="caption-number">Fig. 5.1 </span><span class="caption-text">The orientation of the Cassini UVIS relative to the spacecraft Cartesian coordinate system. Figure from the Cassini UVIS Calibration Report (Bill McClintock, private communication).</span><a class="headerlink" href="#fig-uvis-coordinates" title="Permalink to this image">¶</a></p>
</div>
<p>A review of the UVIS instrument is given by <span id="id2">Esposito <em>et al.</em> [<a class="reference internal" href="bibliography.html#id3">2004</a>]</span>.
In addition, the Cassini UVIS Calibration Report (Bill McClintock, private communication) is an invaluable resource for those wishing a more detailed description of the instrument.</p>
<p>The UVIS flatfield correction is a two-dimensional, multiplicative array applied to data during the reduction process in order to correct for spatial variations in the detector sensitivity.
This is separate from, though closely related to, the instrument calibration which is a one-dimensional multiplicative vector used to correct for variations in the detector sensitivity as a function of wavelength.
In principle, pixel-to-pixel variations in detector sensitivity could be corrected by using a two-dimensional calibration array.
However, for largely historical reasons, these two corrections are applied separately to UVIS data.</p>
<p>The source of the dual correction procedures dates back to laboratory calibration of the UVIS instrument.
The radiometric sensitivity of the UVIS instruments was measured by illuminating a large area of the detector and comparing the flux measured by the UVIS detector to that measured by a NIST calibrated diode, or to theoretical models of the spectrum (e.g. H<span class="math notranslate nohighlight">\(_2\)</span>) used to illuminate the detector.
During the laboratory calibration, the severity of the flatfield artifacts of the UVIS detectors (especially for the FUV channel) was not fully appreciated, and so the counts over the whole detector were summed up to increase the signal to noise ratio.
This process yielded measurements of the detector radiometric sensitivity at a few tens of wavelengths.
The sensitivity at wavelengths other than those directly measured was derived through linear interpolation.
In this manner, a 1024-element multiplicative calibration correction was created.</p>
</div>
<div class="section" id="methods-for-obtaining-flatfield-corrections">
<h2><span class="section-number">5.2. </span>Methods for Obtaining Flatfield Corrections<a class="headerlink" href="#methods-for-obtaining-flatfield-corrections" title="Permalink to this headline">¶</a></h2>
<p>The easiest way to derive a flatfield correction is to illuminate the detector with a spatially-uniform monochromatic source.
In this case, any differences in the number of counts in the individual detector pixels are the result of spatial (pixel-to-pixel) variations in the detector sensitivity (assuming that the signal to noise ratio is large).
However,the presence of a grating in the UVIS optical path means that while the entrance slit may be evenly illuminated, only a small fraction of the detector — the projected width of the slit on the detector divided by the length of the detector, or 3% for the UVIS occultation slits — will be illuminated by a monochromatic source.
This problem can be solved by using a spatially uniform white-light (equal intensity at all wavelengths) source to illuminate the entrance slits.
After dividing the resulting image by the instrument sensitivity as a function of wavelength (also referred to as the detector calibration curve) any pixel variations are due to variations in detector sensitivity.
Sadly though, no such source exists.</p>
<p>The next best thing is to use a spatially uniform source with a known spectrum.
Then, after dividing the raw image by the detector calibration curve and the known spectrum, one can use the pixel to pixel variations to derive a flatfield correction.
Ideally, UVIS would have been taken to a synchrotron radiation facility and the beam source used to illuminate the entrance slits.
However, for various practical reasons (like time and money) this was not possible, and UVIS was launched before the flatfield correction was properly determined.
Therefore, UVIS is limited to using astrophysical sources to derive the flatfield correction.
Unfortunately, astrophysical sources are rarely spatially uniform (the local interstellar medium/interplanetary medium being a possible exception), and the EUV/FUV spectra of such objects (in physical units) are not as
well determined as one might like them to be.</p>
</div>
<div class="section" id="spica-flatfields">
<h2><span class="section-number">5.3. </span>Spica Flatfields<a class="headerlink" href="#spica-flatfields" title="Permalink to this headline">¶</a></h2>
<p>Assuming that the background count rate of an instrument (from RTGs, dark counts, etc.) is low compared to the signal count rate, a star bright in the UV can serve as a good approximation to a spatially uniform source.
The star, Spica, is relatively bright in the EUV/FUV.
Three sets of Spica observations were obtained by UVIS on</p>
<ul class="simple">
<li><p>2001-04-03,</p></li>
<li><p>2002-07-17,</p></li>
<li><p>2003-05-19.</p></li>
</ul>
<div class="section" id="row-to-row-variations-in-detector-sensitivity">
<h3><span class="section-number">5.3.1. </span>Row-to-Row Variations in Detector Sensitivity<a class="headerlink" href="#row-to-row-variations-in-detector-sensitivity" title="Permalink to this headline">¶</a></h3>
<p>Since the absolute radiometric sensitivity of the instrument has already been measured in the lab (albeit in a one-dimensional form), it is only necessary to derive the relative row-to-row, column-to-column or pixel-to-pixel variations in detector sensitivity, and then normalize this relative correction so that the absolute radiometric calibration of the instrument remains unchanged.
This greatly simplifies the process of deriving a flatfield correction from an astrophysical source, since it is no longer critical to know the spectrum of the source object.</p>
<p>The flatfield correction is given by:</p>
<div class="math notranslate nohighlight" id="equation-eq-ff-corr">
<span class="eqno">(5.1)<a class="headerlink" href="#equation-eq-ff-corr" title="Permalink to this equation">¶</a></span>\[F_\lambda = \frac{C_{i,m}}{A_\lambda f_i t}\frac{photons}{cm^2s}\]</div>
<p>where</p>
<ul class="simple">
<li><p>F<span class="math notranslate nohighlight">\(_\lambda\)</span> is the flux from the star at a wavelength of <span class="math notranslate nohighlight">\(\lambda\)</span>,</p></li>
<li><p>C<span class="math notranslate nohighlight">\(_{i,m}\)</span> is the counts observed in a pixel in column <em>i</em> on scan <em>m</em>, (i.e. a spectrum shifted by 0.2 x <em>m</em> mrad)</p></li>
<li><p>A<span class="math notranslate nohighlight">\(_\lambda\)</span> is the effective area of a pixel illuminated with light of wavelength <span class="math notranslate nohighlight">\(\lambda\)</span>, as determined by the
laboratory calibration; and</p></li>
<li><p>f<span class="math notranslate nohighlight">\(_i\)</span> is the flatfield correction for the pixel in column <em>i</em>.</p></li>
</ul>
<p>By rotating the Cassini spacecraft about the X axis, the elevation angle of Spica changes, i.e. it appears to move along the spatial dimension of the detector.
If the rotation of the spacecraft is held at a constant angular velocity, than the star will spend an equal amount of time in each row of the detector.
By starting the observation with the star outside of the UVIS field of view, scanning it uniformly across the slit, and ending the observation with the star outside the instrument’s field of view on the opposite side, each row will have received equal illumination by both the star the scattered light profile associated with the star (assuming that the instrument scattering function is reasonably constant over the length of the entrance slits).</p>
<p>Spica is relatively bright in the EUV/FUV, so photon counting statistics are by far the largest source of noise.
With the integration times used in the Spica observations, the total signal to noise ratio is ~30 for pixels in the EUV detector below 900 <span class="math notranslate nohighlight">\(\AA\)</span> and more than an order of magnitude higher than that for all other pixels.
The “signal” from Spica below 900 <span class="math notranslate nohighlight">\(\AA\)</span> — a significant portion of it is internally-scattered light from longer wavelengths — is ~10 times greater than the count rate produced by the mesa background feature.
Since each row of the detector has received equal illumination from the source and noise in the data is small, any difference in the counts measured in the pixels of a given column must be the result of row-to-row variations in detector sensitivity.</p>
<p>Dividing the average value of pixels in a particular column by the value of an individual pixel in that column yields a relative correction factor for that pixel.
This procedure is described by the following equation:</p>
<div class="math notranslate nohighlight" id="equation-eq-row2row-corr">
<span class="eqno">(5.2)<a class="headerlink" href="#equation-eq-row2row-corr" title="Permalink to this equation">¶</a></span>\[f_{i,j}=\frac{\sum^{60}_{j=3}C_{i,j}}{58C_{i,j}}\]</div>
<p>where</p>
<ul class="simple">
<li><p>f<span class="math notranslate nohighlight">\(_{i,j}\)</span> is the flatfield correction for a pixel in column i, row j, and</p></li>
<li><p>C<span class="math notranslate nohighlight">\(_{i,j}\)</span> is the number of counts in the pixel located in column i, row j.</p></li>
</ul>
<p>The limits of the sum are chosen such that the first few rows on either end of the detector (which are either completely or partially masked out) are excluded.
When applied to all pixels of the detector, <code class="xref std std-numref docutils literal notranslate"><span class="pre">eq:row2row-corr</span></code> yields a two-dimensional flatfield correction.
However, this flatfield only corrects for row-to-row variations in detector sensitivity.
This means that if the detector were illuminated with a spatially-uniform, monochromatic source, all the pixels in a given column would have the same value (within photon counting statistics) after multiplying the raw data by
the flatfield correction described above.
However, pixels in a neighboring column (or any other column on the detector, for that matter) might have a different value, even though they received the same illumination.</p>
</div>
<div class="section" id="column-to-column-varations-in-detector-sensitivity">
<h3><span class="section-number">5.3.2. </span>Column-to-Column Varations in Detector Sensitivity<a class="headerlink" href="#column-to-column-varations-in-detector-sensitivity" title="Permalink to this headline">¶</a></h3>
<p>In order to obtain a correction for the column-to-column variations, it is reasonable to imagine that the spacecraft might be rotated about the Z axis, moving Spica in the dispersion direction on the detector.
However, since Spica is a point source, only a single detector row will be illuminated.
The trick is to start by scanning the star uniformly through the field of view by rotating about the spacecraft X axis, as described above.
After each scan, the spacecraft is rotated slightly about the Z axis and a new scan across length of the slit—in the opposite direction to the previous scan—is begun.</p>
<p>Since the spacecraft was rotated by a small angle between each scan, the stellar spectra from successive scans will be shifted slightly (in the spectral dimension) relative to the previous spectra.
If the rotation between scans is an integer multiple of the angular width of the detector pixels, pixel x in observation a will have received</p>
<div class="math notranslate nohighlight">
\[F_{i,0}=F_{i+\delta,1}=F_{i+2\delta,2}=\cdots = F_{i+m\delta,m}\]</div>
<p>where F<span class="math notranslate nohighlight">\(_{i,m}\)</span> is the flux of photons incident on column i on scan m.</p>
<p>For the UVIS observations of Spica, the azimuth angle of the spacecraft was incremented 0.2 milliradians after each scan across the slit, resulting in a shift to the spectrum of 0.8 pixels (in the dispersion direction) relative to the previous scan.
The subpixel shift in the spectrum between successive scans means that Eq. A.3 is only strictly valid for shifts that are an integer multiple of 5. For the May 2003 observation of Spica, there were 13 scans across
the slit, with a 0.2 milliradian shift between each scan.
Therefore, the following set of equations applies:</p>
<div class="math notranslate nohighlight">
\[F_{i,0} = F_{i+4,5} = F_{i+8,10}\]</div>
<div class="math notranslate nohighlight">
\[F_{i,1} = F_{i+4,6} = F_{i+8,11}\]</div>
<div class="math notranslate nohighlight">
\[F_{i,2} = F_{i+4,7} = F_{i+8,12}\]</div>
<div class="math notranslate nohighlight">
\[F_{i,3} = F_{i+4,8} = F_{i+8,13}\]</div>
<div class="math notranslate nohighlight">
\[F_{i,4} = F_{i+4,9}\]</div>
<p>So for any column on the detector, the column 4 columns away received the
same illumination 5 scans later, and the column 8 columns away received the same
illumination 10 scans later. These three values could be averaged together and the
result divided by the individual pixel values to obtain corrections for the sensitivity
of column i relative to the sensitivity of columns i+4 and i+8. There are four sets
of these identically illuminated triplets with one additional pair. Using all five sets
results in five correction factors for the sensitivity of a given column relative to its
neighbors. To decrease the statistical error in the correction factor for a given pixel, the
five values could be averaged together. This procedure, applied to all columns on the
detector produces a flatfield correction that compensates for the variations in detector
sensitivity from column to column.</p>
<p>Although this procedure works reasonably well for the EUV channel, where the 8-
milliradian-wide occultation slit could be used, it fails for the FUV channel, where, owing
to the presence MgF 2 lens and its support structure in the center of the occultation slit,
the lo-resolution slit was used. Since the FUV lo-resolution slit is only 1.5 milliradians
wide, Spica will be in the field of view on, at most, 7 scans. A slight twist in the slit
further reduces the number of usable scans to 5. Therefore, only the first two columns
of Eq. A.7 are applicable. Since each pixel is compared with only one other pixel on the
detector, this method is quite susceptible to errors.</p>
<p>By making the assumption that the flux of photons varies slowly over the range in
wavelength covered by one pixel, it is possible to use all scans where the target (Spica) is
within the UVIS field of view. The UVIS EUV channel has a spectral resolution of 2.25A
(2.75A FUV) FWHM (full width at half-maximum) and a dispersion of 0.6049A/pixel
(0.7794A/pixel FUV); more than 3 pixels fit into the width of a spectral resolution
element. Since the UVIS instruments are oversampled in the spectral dimension, the
above assumption is valid. W ith this assumption, the following set of equations now
holds:</p>
<div class="math notranslate nohighlight">
\[F_{i,m}A_\lambda t = \frac{1.0C_{i,m}}{f_i}
F_{i,m}A_\lambda t = \frac{0.2C_{i,1}}{f_i} + \frac{0.8C_{i+1,m+1}}{f_{i+1}}
F_{i,m}A_\lambda t = \frac{0.4C_{i+1,2}}{f_{i+1}} + \frac{0.6C_{i+2,m+2}}{f_{i+2}}
F_{i,m}A_\lambda t = \frac{0.6C_{i+2,3}}{f_{i+2}} + \frac{0.4C_{i+3,m+3}}{f_{i+3}}
F_{i,m}A_\lambda t = \frac{0.8C_{i+3,4}}{f_{i+3}} + \frac{0.2C_{i+4,m+4}}{f_{i+4}}\]</div>
<p>To see how equations A.9-A.13 are derived, we refer to Table A.l and Eq. A.I.</p>
<p>The top half of Table A .l shows a schematic representation of 5 pixels lying in the same
row on the detector. For each pixel, there is a flatfield correction, f,, that will be derived.
The number of counts observed in the pixel in column i on scan m is given by Q jTO.
Each pixel is divided into 5 equal subpixel regions. The lower half of Table A .l shows
schematically the illumination each pixel is receiving on each of 5 scans. The spectrum
of Spica is given as F^, and it is assumed that the spectrum is constant over the width
of one pixel (AA). On scan 0, each pixel is fully illuminated by a single spectral element
e.g. column i is completely illuminated by F^. Eq. A.9 is derived from this information
and Eq. A .l. On scan 1, the position of Spica on the detector has been displaced by 0.2
milliradians in the dispersion direction relative to its position on scan 0. As a result,
only 1/5 of F A now falls on the pixel in column i, with the remaining 4/5 falling on
the pixel in column i+1. information about the location of the spectral element F a can
again be used in conjunction with Eq.A.l to derive Eq. A.10, and so on, until all five
equations have been derived.</p>
<p>Equations A.9-A.13 form a system of 6 unknowns (Fa, b, b+i, fi+2, fj+3, fi+4)
in 5 equations. In order to solve this system, it is necessary to supply an additional
equation. This equation is obtained by assuming that the average row-to-row flatfield
correction has a value of 1. As the number of points included in the row-to-row calculation increases, the validity of this assumption increases. The reason for this is that
the average flatfield correction, when the entire detector is considered, must be equal
to 1. If the average flatfield correction over the whole detector were not equal to 1, this
would have the effect of modifying the laboratory calibration. This assumption yields
a final equation:</p>
<div class="math notranslate nohighlight">
\[\frac{f_i+f_{i+1}+f_{i+2}+f_{i+3}+f_{i+4}}{5}=1\]</div>
<p>which can be used to close the system and solve for the various flatfield corrections. This
technique can be readily extended to an include an arbitrary number of vertical scans.
For each point on the detector, m flatfield correction factors are produced, where m is
the number of scans. These are then averaged together to produce a better estimate of
the “true” column-to-column flatfield correction.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="bibliography.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">4. </span>Bibliography</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Appendix2.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Definitions and technical terms</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Cassini UVIS team, Jupyter Book created by Michael Aye<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>